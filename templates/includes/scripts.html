<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Menu mobile
        const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
        const navMenu = document.querySelector('.nav-menu');
       
        if (mobileMenuToggle) {
            mobileMenuToggle.addEventListener('click', function() {
                navMenu.classList.toggle('active');
                this.querySelector('i').classList.toggle('fa-bars');
                this.querySelector('i').classList.toggle('fa-times');
            });
        }
       
        // Gestion des menus déroulants sur mobile
        const dropdowns = document.querySelectorAll('.dropdown > a');
       
        dropdowns.forEach(dropdown => {
            dropdown.addEventListener('click', function(e) {
                if (window.innerWidth <= 768) {
                    e.preventDefault();
                    const parent = this.parentElement;
                    parent.classList.toggle('active');
                }
            });
        });
       
        // Compte à rebours principal
        function updateCountdown() {
            const countdownDate = new Date();
            countdownDate.setDate(countdownDate.getDate() + 12); // 12 jours à partir d'aujourd'hui
           
            const now = new Date().getTime();
            const distance = countdownDate - now;
           
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
           
            document.getElementById('days').textContent = days.toString().padStart(2, '0');
            document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
            document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
            document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
        }
       
        // Compte à rebours ventes flash
        function updateFlashCountdown() {
            const now = new Date();
            const endOfDay = new Date();
            endOfDay.setHours(23, 59, 59, 999);
           
            const distance = endOfDay - now;
           
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
           
            document.getElementById('flash-hours').textContent = hours.toString().padStart(2, '0');
            document.getElementById('flash-minutes').textContent = minutes.toString().padStart(2, '0');
            document.getElementById('flash-seconds').textContent = seconds.toString().padStart(2, '0');
        }
       
        // Mettre à jour les comptes à rebours
        setInterval(updateCountdown, 1000);
        setInterval(updateFlashCountdown, 1000);
        updateCountdown();
        updateFlashCountdown();
       
        // Filtrage des produits
        const filterButtons = document.querySelectorAll('.filter-btn');
        const productCards = document.querySelectorAll('.product-card');
       
        filterButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Retirer la classe active de tous les boutons
                filterButtons.forEach(btn => btn.classList.remove('active'));
                // Ajouter la classe active au bouton cliqué
                this.classList.add('active');
               
                const category = this.getAttribute('data-category');
               
                // Filtrer les produits
                productCards.forEach(card => {
                    if (category === 'all' || card.getAttribute('data-category') === category) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                });
            });
        });
       
        // Ajout au panier
        const addToCartButtons = document.querySelectorAll('.add-to-cart');
        const cartCount = document.querySelector('.cart-count');
        let count = parseInt(cartCount.textContent);
       
        addToCartButtons.forEach(button => {
            button.addEventListener('click', function() {
                count++;
                cartCount.textContent = count;
               
                // Animation de feedback
                const originalHTML = this.innerHTML;
                this.innerHTML = '<i class="fas fa-check"></i>';
                this.style.backgroundColor = '#27ae60';
               
                setTimeout(() => {
                    this.innerHTML = originalHTML;
                    this.style.backgroundColor = '';
                }, 1500);
            });
        });
    });

            // Animation au défilement (index-specific)
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = 1;
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);
        
        // Observer les sections pour l'animation
        const sections = document.querySelectorAll('.categories, .featured-products, .promotions, .newsletter');
        sections.forEach(section => {
            section.style.opacity = 0;
            section.style.transform = 'translateY(20px)';
            section.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            observer.observe(section);
        });

        // Menu mobile (index-specific, compatible avec promotions)
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const navMenu = document.querySelector('.nav-menu');
        
        if (mobileMenuBtn && navMenu) {
            mobileMenuBtn.addEventListener('click', function() {
                navMenu.classList.toggle('active');
                this.innerHTML = navMenu.classList.contains('active') ? 
                    '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
            });
        }

        // Fermer le menu mobile en cliquant à l'extérieur
        document.addEventListener('click', function(event) {
            if (!event.target.closest('nav') && !event.target.closest('.mobile-menu-btn')) {
                navMenu.classList.remove('active');
                mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
            }
        });

                    // Gestion de la vue (grille/liste) - article-specific
            const viewButtons = document.querySelectorAll('.view-btn');
            const productsContainer = document.getElementById('products-container');
            
            if (viewButtons.length > 0 && productsContainer) {
                viewButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        // Retirer la classe active de tous les boutons
                        viewButtons.forEach(btn => btn.classList.remove('active'));
                        // Ajouter la classe active au bouton cliqué
                        this.classList.add('active');
                        
                        // Changer la vue
                        const viewType = this.getAttribute('data-view');
                        if (viewType === 'list') {
                            productsContainer.classList.add('list-view');
                        } else {
                            productsContainer.classList.remove('list-view');
                        }
                    });
                });
            }
            
            // Animation au défilement pour produits - article-specific
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = 1;
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);
            
            // Observer les produits pour l'animation
            const productCards = document.querySelectorAll('.product-card');
            productCards.forEach(card => {
                card.style.opacity = 0;
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(card);
            });
            
            // Simulation d'ajout au panier - article-specific
            const addToCartButtons = document.querySelectorAll('.add-to-cart');
            const cartCount = document.querySelector('.cart-count');
            let count = parseInt(cartCount ? cartCount.textContent : 0);
            
            addToCartButtons.forEach(button => {
                button.addEventListener('click', function() {
                    count++;
                    if (cartCount) cartCount.textContent = count;
                    
                    // Animation de feedback
                    const originalHTML = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i> Ajouté';
                    this.style.backgroundColor = '#27ae60';
                    
                    setTimeout(() => {
                        this.innerHTML = originalHTML;
                        this.style.backgroundColor = '';
                    }, 1500);
                });
            });

                        // Gestion de la vue (grille/liste) - article-specific
            const viewButtons = document.querySelectorAll('.view-btn');
            const productsContainer = document.getElementById('products-container');
            
            if (viewButtons.length > 0 && productsContainer) {
                viewButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        // Retirer la classe active de tous les boutons
                        viewButtons.forEach(btn => btn.classList.remove('active'));
                        // Ajouter la classe active au bouton cliqué
                        this.classList.add('active');
                        
                        // Changer la vue
                        const viewType = this.getAttribute('data-view');
                        if (viewType === 'list') {
                            productsContainer.classList.add('list-view');
                        } else {
                            productsContainer.classList.remove('list-view');
                        }
                    });
                });
            }
            
            // Animation au défilement pour produits - article-specific
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = 1;
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);
            
            // Observer les produits pour l'animation
            const productCards = document.querySelectorAll('.product-card');
            productCards.forEach(card => {
                card.style.opacity = 0;
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(card);
            });
            
            // Simulation d'ajout au panier - article-specific
            const addToCartButtons = document.querySelectorAll('.add-to-cart');
            const cartCount = document.querySelector('.cart-count');
            let count = parseInt(cartCount ? cartCount.textContent : 0);
            
            addToCartButtons.forEach(button => {
                button.addEventListener('click', function() {
                    count++;
                    if (cartCount) cartCount.textContent = count;
                    
                    // Animation de feedback
                    const originalHTML = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i> Ajouté';
                    this.style.backgroundColor = '#27ae60';
                    
                    setTimeout(() => {
                        this.innerHTML = originalHTML;
                        this.style.backgroundColor = '';
                    }, 1500);
                });
            });

                // Galerie d'images - detail-specific
            const thumbnails = document.querySelectorAll('.thumbnail');
            const mainImage = document.getElementById('main-image');
            
            if (thumbnails.length > 0 && mainImage) {
                thumbnails.forEach(thumbnail => {
                    thumbnail.addEventListener('click', function() {
                        thumbnails.forEach(t => t.classList.remove('active'));
                        this.classList.add('active');
                        mainImage.src = this.getAttribute('data-image');
                    });
                });
            }
            
            // Sélecteur de couleur - detail-specific
            const colorOptions = document.querySelectorAll('.color-option');
            colorOptions.forEach(option => {
                option.addEventListener('click', function() {
                    colorOptions.forEach(o => o.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Sélecteur de taille - detail-specific
            const sizeOptions = document.querySelectorAll('.size-option');
            sizeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    sizeOptions.forEach(o => o.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Sélecteur de quantité - detail-specific
            const minusBtn = document.querySelector('.quantity-btn.minus');
            const plusBtn = document.querySelector('.quantity-btn.plus');
            const quantityInput = document.querySelector('.quantity-input');
            
            if (minusBtn && plusBtn && quantityInput) {
                minusBtn.addEventListener('click', function() {
                    let value = parseInt(quantityInput.value);
                    if (value > 1) quantityInput.value = value - 1;
                });
                
                plusBtn.addEventListener('click', function() {
                    let value = parseInt(quantityInput.value);
                    quantityInput.value = value + 1;
                });
            }
            
            // Tabs - detail-specific
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    const targetTab = document.getElementById(tabId);
                    if (targetTab) targetTab.classList.add('active');
                });
            });
            
            // Ajout au panier - detail-specific
            const addToCartBtn = document.querySelector('.add-to-cart');
            const cartCount = document.querySelector('.cart-count');
            let count = parseInt(cartCount ? cartCount.textContent : 0);
            
            if (addToCartBtn && quantityInput) {
                addToCartBtn.addEventListener('click', function() {
                    const quantity = parseInt(quantityInput.value);
                    count += quantity;
                    if (cartCount) cartCount.textContent = count;
                    
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i> Ajouté au panier';
                    this.style.backgroundColor = '#27ae60';
                    
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.style.backgroundColor = '';
                    }, 2000);
                });
            }
            
            // Liste de souhaits - detail-specific
            const wishlistBtn = document.querySelector('.wishlist-btn');
            
            if (wishlistBtn) {
                wishlistBtn.addEventListener('click', function() {
                    this.classList.toggle('active');
                    if (this.classList.contains('active')) {
                        this.innerHTML = '<i class="fas fa-heart"></i>';
                        this.style.backgroundColor = '#e74c3c';
                        this.style.color = 'white';
                    } else {
                        this.innerHTML = '<i class="far fa-heart"></i>';
                        this.style.backgroundColor = '';
                        this.style.color = '';
                    }
                });
            }

                        // Gestion des méthodes de paiement - payments-specific
            const paymentOptions = document.querySelectorAll('.payment-option');
            const paymentContents = document.querySelectorAll('.payment-method-content');
            
            if (paymentOptions.length > 0) {
                paymentOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        paymentOptions.forEach(opt => opt.classList.remove('selected'));
                        this.classList.add('selected');
                        
                        const radio = this.querySelector('input[type="radio"]');
                        if (radio) radio.checked = true;
                        
                        const method = this.getAttribute('data-method');
                        paymentContents.forEach(content => {
                            content.style.display = 'none';
                        });
                        const targetContent = document.getElementById(method + '-content');
                        if (targetContent) targetContent.style.display = 'block';
                    });
                });
            }
            
            // Formatage du numéro de carte - payments-specific
            const cardNumberInput = document.getElementById('card-number');
            
            if (cardNumberInput) {
                cardNumberInput.addEventListener('input', function() {
                    let value = this.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
                    let formattedValue = '';
                    
                    for (let i = 0; i < value.length; i++) {
                        if (i > 0 && i % 4 === 0) {
                            formattedValue += ' ';
                        }
                        formattedValue += value[i];
                    }
                    
                    this.value = formattedValue;
                });
            }
            
            // Formatage de la date d'expiration - payments-specific
            const expiryDateInput = document.getElementById('expiry-date');
            
            if (expiryDateInput) {
                expiryDateInput.addEventListener('input', function() {
                    let value = this.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
                    
                    if (value.length >= 2) {
                        this.value = value.substring(0, 2) + '/' + value.substring(2, 4);
                    }
                });
            }
            
            // Validation du formulaire - payments-specific
            const paymentForm = document.getElementById('payment-form');
            
            if (paymentForm) {
                paymentForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const selectedMethod = document.querySelector('.payment-option.selected').getAttribute('data-method');
                    
                    if (selectedMethod === 'card') {
                        const cardNumber = document.getElementById('card-number').value;
                        const expiryDate = document.getElementById('expiry-date').value;
                        const cvv = document.getElementById('cvv').value;
                        const cardholder = document.getElementById('cardholder').value;
                        
                        if (!cardNumber || !expiryDate || !cvv || !cardholder) {
                            alert('Veuillez remplir tous les champs obligatoires pour le paiement par carte.');
                            return;
                        }
                        
                        if (cardNumber.replace(/\s/g, '').length !== 16) {
                            alert('Veuillez saisir un numéro de carte valide (16 chiffres).');
                            return;
                        }
                    }
                    
                    // Simulation de traitement
                    const submitBtn = paymentForm.querySelector('button[type="submit"]');
                    const originalText = submitBtn.innerHTML;
                    
                    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Traitement en cours...';
                    submitBtn.disabled = true;
                    
                    setTimeout(() => {
                        window.location.href = 'confirmation.html';
                    }, 2000);
                });
            }
</script>